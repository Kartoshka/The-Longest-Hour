using UnityEngine;
using System.Collections;

/// <summary>
/// If this is a component:
///     Retrieves Unity information and passes it to the abstract data type.
/// </summary>
public class SpawnTileColliderEvent : MonoBehaviour
{
	//////////////////////////////////////////////////////////////////////////////////////////
	#region GameObjects
	//////////////////////////////////////////////////////////////////////////////////////////   

	public ERSpawnManager m_spawnManager;
    public ERBackgroundManager m_backGroundManager;
	public GameObject m_nextTileSpawnLocation;
    public GameObject m_objectToSpawn;

	#endregion
	//////////////////////////////////////////////////////////////////////////////////////////
	#region Attributes - These will either be created by this class or set by a another.
	//////////////////////////////////////////////////////////////////////////////////////////

	public bool m_triggerOnce = true;

	private bool m_triggerEntered = false;
	private bool m_isTriggered = false;

	#endregion
	//////////////////////////////////////////////////////////////////////////////////////////
	#region Accessors
	//////////////////////////////////////////////////////////////////////////////////////////

	#endregion
	//////////////////////////////////////////////////////////////////////////////////////////
	#region Methods
	//////////////////////////////////////////////////////////////////////////////////////////  

	#endregion
	//////////////////////////////////////////////////////////////////////////////////////////
	#region Runtime
	//////////////////////////////////////////////////////////////////////////////////////////  

	void Start()
	{

    }

	void OnTriggerEnter(Collider other)
	{
		if (m_triggerOnce && !m_isTriggered && !m_triggerEntered)
		{
			m_triggerEntered = true;
            if (other.gameObject.tag.Equals("Player"))
			{
				if (m_objectToSpawn != null)
				{
					m_spawnManager.spawnNextTile(m_objectToSpawn, m_nextTileSpawnLocation.transform.position);
				}
				else
				{
					m_spawnManager.spawnNextTile(m_nextTileSpawnLocation.transform.position, m_nextTileSpawnLocation.transform.rotation);
				}
				GameObject bgSpawnLocation = GameObject.FindGameObjectWithTag("BGspawn");
				m_backGroundManager.spawnBGTile(bgSpawnLocation);
				gameObject.SetActive(false);
				m_isTriggered = true;
			}
			m_triggerEntered = false;
		}
	}

	#endregion
	//////////////////////////////////////////////////////////////////////////////////////////
	#region Persistence
	//////////////////////////////////////////////////////////////////////////////////////////

	#endregion
}